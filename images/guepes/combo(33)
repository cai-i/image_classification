YUI.add("group-recs-rail-item-view",(function(t,e){require("hermes-core/flog")(e);t.namespace("Views")[this.name]=t.Base.create("group-recs-rail-item-view",t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.params=e,this.params.groupId=this.params.id,this.justifiedLayout=require("justified-layout"),this.photoSizeHelper=new t.PhotoSizeHelper(this.appContext),this},loadState:function(){return t.Promise.resolve()},buildContainer:function(){this.setContainerWithTemplate("group-recs-rail-item",this.params)},activate:function(){var t=this.get("container");return this.listContainerNode=t.one(".list-container"),this.dummyLoaderNode=this.listContainerNode.one(".dummy-loader"),this.joinButtonContainer=t.one(".join-button-container"),this.buildLayout(),this.buildJoinButton()},buildLayout:function(){var e,i=this,o=t.Node.create('<div class="group-photo-layout"></div>'),n=this.params.photos,r=n.map((function(t){return Math.min(t.aspectRatio,2)})),a=0,s=0,h=0;(e=i.justifiedLayout(r,{containerWidth:this.listContainerNode.get("clientWidth"),containerPadding:0,boxSpacing:{horizontal:4,vertical:4},targetRowHeight:50,targetRowHeightTolerance:.2})).boxes.some((function(t,i){s<t.top&&(s=t.top,++a>=1&&(h=h||i,e.containerHeight=e.containerHeight-t.height-4))})),h||(h=e.boxes.length),e.boxes=e.boxes.slice(0,h),o.setStyle("position","relative"),o.setStyle("height",e.containerHeight),e.boxes.forEach((function(e,r){var a=n[r],s=t.Node.create('<a class="group-photo-item" href="'+a.link+'" data-item-id="'+a.id+'"></a>'),h=i.photoSizeHelper.getSizeToFit(a.sizes,{width:e.width,height:e.height},{includeSquare:!1}),l=h?h.displayUrl:a.url;s.setStyle("background-image","url("+l+")"),s.setStyle("top",e.top),s.setStyle("left",e.left),s.setStyle("width",e.width),s.setStyle("height",e.height),o.appendChild(s)})),this.listContainerNode.appendChild(o)},buildJoinButton:function(){var t=this;return this.appContext.getView("join-group-view",{groupId:this.params.id,useSearchModel:!1,theme:"flex-hollow",shortLabels:!0}).then((function(t){return t.initialize()})).then((function(e){return t.joinButtonContainer.appendChild(e.get("container")),e.activate()}))}})}),"@VERSION@",{requires:["flickr-view","join-group-view","hermes-template-group-recs-rail-item"],optionalRequires:["hermes-core"],langBundles:["common"]});YUI.add("hermes-template-group-recs-rail-card",(function(t,i){var s=t.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(t,i,s,e,n){var a=t.lookupProperty||function(t,i){if(Object.prototype.hasOwnProperty.call(t,i))return t[i]};return'<div class="group-recs-rail-card">\n\t<h2 class="title">\n\t\t'+t.escapeExpression((a(s,"intlMessage")||i&&a(i,"intlMessage")||t.hooks.helperMissing).call(null!=i?i:t.nullContext||{},{name:"intlMessage",hash:{intlName:"feed.GROUPS_FOR_YOU"},data:n,loc:{start:{line:3,column:2},end:{line:3,column:48}}}))+'\n\t</h2>\n\t<div class="list-container">\n\t\t<div class="dummy-loader">\n\t\t\t<div class="row">\n\t\t\t\t<div class="attribution-section">\n\t\t\t\t\t<div class="attribution-left">\n\t\t\t\t\t\t<div class="box ava" style="height: 32px; width: 32px"></div>\n\t\t\t\t\t\t<div class="box" style="height: 14px; width: 30%"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="attribution-right">\n\t\t\t\t\t\t<div class="box" style="height: 32px; width: 64px"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="list-section">\n\t\t\t\t\t<div class="box" style="height: 60px; width: 30%"></div>\n\t\t\t\t\t<div class="box" style="height: 60px; width: 20%"></div>\n\t\t\t\t\t<div class="box" style="height: 60px; width: 25%"></div>\n\t\t\t\t\t<div class="box" style="height: 60px; width: 20%"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<div class="attribution-section">\n\t\t\t\t\t<div class="attribution-left">\n\t\t\t\t\t\t<div class="box ava" style="height: 32px; width: 32px"></div>\n\t\t\t\t\t\t<div class="box" style="height: 14px; width: 30%"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="attribution-right">\n\t\t\t\t\t\t<div class="box" style="height: 32px; width: 64px"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="list-section">\n\t\t\t\t\t<div class="box" style="height: 60px; width: 20%"></div>\n\t\t\t\t\t<div class="box" style="height: 60px; width: 20%"></div>\n\t\t\t\t\t<div class="box" style="height: 60px; width: 30%"></div>\n\t\t\t\t\t<div class="box" style="height: 60px; width: 25%"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n'},useData:!0}),e={};t.Array.each([],(function(i){var s=t.Template.get("hermes/"+i);s&&(e[i]=s)})),t.Template.register("hermes/group-recs-rail-card",(function(i,n){return(n=n||{}).partials=n.partials?t.merge(e,n.partials):e,s(i,n)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("flickr-groups-recommendations-fetcher",(function(e,r){"use strict";function o(e){return e.sample_photos_count=8,e}e.namespace("ModelFetchers")["flickr-groups-recommendations"]={run:function(s,p){var t=this,n=o({page:s.page||1,per_page:s.perPage||4,extras:(s.extras||"")+",icon_urls, sizes"});return e.Promise.all([p.callAPI("flickr.groups.recommendations",n,!0),p.getModelRegistry("group-recommended-list-models"),p.getModelRegistry("group-recommended-models")]).then((function(e){return t._processResponse(e,n,s)}),e.FetcherErrorLogger(r))},_processParams:o,_processResponse:function(r,o,s){var p=r[0].groups.group,t=r[1],n=r[2],a={},i=[];return e.each(p,(function(e){var r;e.id=e.nsid,r=n.parseGroupModel(e),n.addOrUpdate(r),i.push(n.proxy(r.id))})),a.id="none",a.groups={perPage:o.per_page,page:o.page,pageContent:i,totalItems:r[0].groups.total},t.addOrUpdate(a),i}}}),"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["group-info-models","group-models"]});YUI.add("group-recommended-list-models",(function(e){function r(e){r.superclass.constructor.call(this,e)}e.Models[this.name]=r,e.extend(r,e.FlickrModelRegistry,{name:this.name,remote:{read:function(r){return e.ModelFetchers["flickr-groups-recommendations"].run(r,this.appContext)}},attributes:{groups:{isCollection:!0,pageFetch:{listFetcher:e.ModelFetchers["flickr-groups-recommendations"]}}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-groups-recommendations-fetcher","attribute-helpers"]});YUI.add("group-recs-rail-card-view",(function(e,t){require("hermes-core/flog")(t);e.namespace("Views")[this.name]=e.Base.create("group-recs-rail-card-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){this.params=e,this.groupRecs=e.groupRecs,this.justifiedLayout=require("justified-layout")},loadState:function(){return e.Promise.resolve()},buildContainer:function(){this.setContainerWithTemplate("group-recs-rail-card",{})},activate:function(){var t=this,i=this.get("container");return this.isRerender||e.Analytics.sendClick("Rail Card Type: Group Recs","Rail Card Loaded"),this.listContainerNode=i.one(".list-container"),this.dummyLoaderNode=this.listContainerNode.one(".dummy-loader"),this.currentContainerWidth=i.get("clientWidth"),this.registerEventHandler(e.globalEvents.subscribe("window:resize",e.betterThrottle(this.handlePageResize.bind(this),1e3,this,!0))),(this.groupRecs&&this.groupRecs.length>0?e.Promise.resolve():this.loadRecs()).then((function(){return t.buildLayout()})).then((function(){t.dummyLoaderNode.addClass("hidden")}))},buildLayout:function(){var e=this;e.groupRecs.forEach((function(t){e.buildGroupLayout(t)}))},buildGroupLayout:function(e){var t=this;this.appContext.getView("group-recs-rail-item-view",Object.assign({appContext:this.appContext},e)).then((function(e){return e.initialize()})).then((function(e){return t.listContainerNode.appendChild(e.get("container")),e.activate()}))},loadRecs:function(){var e=this;return this.appContext.getModel("group-recommended-list-models",{id:"none",perPage:2}).then((function(t){e.recsModel=t,e.groupRecs=t.getValue("groups").getList().map((function(e){return Object.assign({model:e},e.toJSON())}))}))},handlePageResize:function(){var e=this.get("container").get("clientWidth");e!==this.currentContainerWidth&&(this.currentContainerWidth=e,this.rerender())},rerender:function(){this.isRerender=!0,this.detachRegisteredEvents(),this.buildContainer(),this.activate()}})}),"@VERSION@",{requires:["flickr-view","photo-card-view","group-recs-rail-item-view","hermes-template-group-recs-rail-card","hermes-template-group-recs-rail-item","hermes-template-adult-content-photo-overlay","group-recommended-list-models"],optionalRequires:["hermes-core"],langBundles:["common","adult-content-overlay","feed"]});YUI.add("hermes-template-group-discussion-rail-card",(function(t,i){var s=t.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(t,i,s,n,a){var e=t.lookupProperty||function(t,i){if(Object.prototype.hasOwnProperty.call(t,i))return t[i]};return'<div class="group-discussion-rail-card">\n\t<h2 class="title">\n\t\t<a href="/recent.gne">'+t.escapeExpression((e(s,"intlMessage")||i&&e(i,"intlMessage")||t.hooks.helperMissing).call(null!=i?i:t.nullContext||{},{name:"intlMessage",hash:{intlName:"feed.GROUP_DISCUSSIONS"},data:a,loc:{start:{line:3,column:24},end:{line:3,column:73}}}))+'</a>\n\t</h2>\n\t<div class="list-container">\n\t\t<div class="dummy-loader">\n\t\t\t<div class="row">\n\t\t\t\t<div class="attribution-section">\n\t\t\t\t\t<div class="attribution-left">\n\t\t\t\t\t\t<div class="box ava" style="height: 32px; width: 32px"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="attribution-right">\n\t\t\t\t\t\t<div class="box" style="height: 14px; width: 90%"></div>\n\t\t\t\t\t\t<div class="box" style="height: 12px; width: 60%"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<div class="attribution-section">\n\t\t\t\t\t<div class="attribution-left">\n\t\t\t\t\t\t<div class="box ava" style="height: 32px; width: 32px"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="attribution-right">\n\t\t\t\t\t\t<div class="box" style="height: 14px; width: 80%"></div>\n\t\t\t\t\t\t<div class="box" style="height: 12px; width: 70%"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<div class="attribution-section">\n\t\t\t\t\t<div class="attribution-left">\n\t\t\t\t\t\t<div class="box ava" style="height: 32px; width: 32px"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="attribution-right">\n\t\t\t\t\t\t<div class="box" style="height: 14px; width: 85%"></div>\n\t\t\t\t\t\t<div class="box" style="height: 12px; width: 60%"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n'},useData:!0}),n={};t.Array.each([],(function(i){var s=t.Template.get("hermes/"+i);s&&(n[i]=s)})),t.Template.register("hermes/group-discussion-rail-card",(function(i,a){return(a=a||{}).partials=a.partials?t.merge(n,a.partials):n,s(i,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});